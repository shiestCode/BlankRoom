> 此笔记为《图解HTTP》的笔记记录

---------------

01-25-2021

#### 使用HTTP协议访问Web

```mermaid
graph LR
browser[浏览器/客户端]
server[服务器]
browser--1.在地址栏输入URL-->server
server--2.返回文件资源-->browser
```

服务器和客户端之间的通讯就是基于HTTP协议

HTTP是基于TCP/IP协议族的，TCP/IP最最重要的就是分层(分为应用层,传输层,网络层,数据链路层)

分层之后对于更改更加友好，应用层就只需要关注应用层的变化

> **应用层**
>
> ​	决定了向用户提供应用服务时通信的活动。FTP,DNS,HTTP都是该层。
>
> **传输层**
>
> ​	对应用层提供处于网络连接中的两台计算机之间的数据从传输。TCP和UDP就是代表。
>
> **网络层**
>
> ​	网络层用来处理在网络上流动的数据包。数据包是网络传输的最小数据单元
>
> ​	网络层规定通过怎样的路径到达对方的计算机，并把数据包传送给对方
>
> ​	网络层所起的作用就是在众多的选项中选择一条传输路线。
>
> **数据链路层**
>
> ​	处理连接网络的硬件部分。包括操作系统,硬件的设备驱动,NIC(网卡)光纤

#### TCP/IP通信传输流

客户端	在应用层发送一个想看某个Web页面的Http请求,

在传输层(TCP)把http协议进行分割，在报文上打上`标记序号`和`端口号`后转发到网络层

在网络层(IP)增加作为通信目的地的`MAC地址`转发到数据链路层

接收端	在链路层接收到数据,按照顺序往上层发送,一直到应用层

http请求就到了服务器

#### 负责传输的IP协议

作用:把各种数据包传给对方。为了保证数据包真正的传输需要满足各类条件:IP

地址和MAC地址。IP地址指明了节点被分配到的地址，MAC地址是指网卡所属固定地址。

IP地址可以和MAC地址进行配对，IP地址可变换,MAC地址基本上不会更改。

##### ARP协议(Address Resolution Protocol)

根据通讯方的IP地址可以反查出对应的MAC地址

-------------

#### 确保可靠性的TCP协议

TCP属于传输层，提供可靠的字节流服务

字节流服务就是为了方便传输,将大块数据分隔成报文段(segment)为单位的数据包进行管理

可靠的传输服务:能够把数据准确可靠的传给对方。

TCP协议为了更容易传输大数据才把数据进行分割,TCP协议能够确认数据最终是否能发送给对方

##### 确保数据能够到达目标

TCP通过三次握手保证数据准确的送到目标处

> 发送端首先发送一个带SYN标志的数据包发给对方
>
> 接收端回传一个SYN/ACK标志的数据包表示传达确认信息
>
> 发送端再回传一个带ACK标志的数据包表示握手结束

----------------

#### 负责域名解析的DNS服务

DNS和HTTP一样处于应用层。提供了域名到IP地址的解析服务。

用户通常使用主机名或者域名来访问对方的计算机.

而不是直接通过IP地址访问，DNS就提供了DNS将域名解析成IP地址或者逆向IP到域名

---------------

#### URI统一资源标识符(Uniform Resource Identifier)

URI用字符串标识某一互联网资源

URL表示资源的地点

````
http://user:pass@www.example.jp:80/dir/index.htm?uid=1#ch1
user:pass指登录信息
www.example.jp服务器地址
80服务器端口
````

-----------------

2021-02-03

## 简单HTTP协议

##### HTTP协议用于客户端和服务端之间的通信

##### 请求和响应的交换达成通信

> 请求报文有请求方法,请求URI,协议版本,可选的首部字段,内容实体构成

http协议是无状态,我们可以使用Cookie进行状态管理

```mermaid
graph LR

subgraph 存在Cookie的请求
c2[客户端]
s2[服务端]
c2 --1.添加Cookie的请求--> s2
s2 --2.检查Cookie--> s2
s2 --3.响应--> c2
end

subgraph 没有Cookie信息状态的请求
c1[客户端]
s[服务端]
c1 --1.请求--> s
s --2.生成Cookie--> s
s --3.在响应中添加Cookie--> c1
c1 --4.保存Cookie--> c1
end

```

-----------

##### 代理

代理服务器的基本行为就是接受客户端发送的请求后转发给其他服务器

代理不会改变请求的URI,会直接发送给前方持有资源的目标服务器

从源服务器返回的响应经过代理服务器后在传给客户端

```mermaid
graph LR
客户端-->代理服务器Proxy1-->代理服务器Proxy2-->源服务器
```

```mermaid
graph RL
源服务器-->代理服务器Proxy2-->代理服务器Proxy1-->客户端
```

代理转发时需要加上Via表示经过的主机信息

###### 缓存代理

代理转发响应时,缓存代理会预先资源的副本保存在代理服务器上，

当代理接收到相同资源的请求时,就可以不从源服务器上获取资源，直接将缓存的资源作为响应返回

###### 透明代理

转发请求或者响应时,不对报文做任何加工的代理类被称为透明代理,反之就是非透明代理.

-----------

##### 网关

网关可以有HTTP协议转换为其他协议通信

-----------

##### 隧道

隧道可以按照要求建立一条与其他服务器的通信线路，届时使用SSL等加密手段进行通信.

--------

106